{"ast":null,"code":"import _slicedToArray from\"D:/ReactProjects/grocery-site/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useDispatch}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{useEffect,useState}from\"react\";import{logout,verifyUser}from\"../../actions/auth\";import Loading from\"../loading/Loading\";import{jsx as _jsx}from\"react/jsx-runtime\";var PrivateRoute=function PrivateRoute(_ref){var component=_ref.component,role=_ref.role;var dispatch=useDispatch();var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),auth=_useState2[0],setAuth=_useState2[1];useEffect(function(){var onError=function onError(){dispatch(logout);navigate('/login');};var onSuccess=function onSuccess(user){if(!role||role===user.role)return setAuth(true);navigate('/401');};dispatch(verifyUser(onSuccess,onError));},[dispatch,navigate,role]);if(auth)return component;return/*#__PURE__*/_jsx(Loading,{text:'Verifying'});};export default PrivateRoute;","map":{"version":3,"names":["useDispatch","useNavigate","useEffect","useState","logout","verifyUser","Loading","PrivateRoute","component","role","dispatch","navigate","auth","setAuth","onError","onSuccess","user"],"sources":["D:/ReactProjects/grocery-site/client/src/components/privete-route/PrivateRoute.js"],"sourcesContent":["import {useDispatch} from \"react-redux\";\nimport {useNavigate} from \"react-router-dom\";\nimport {useEffect, useState} from \"react\";\nimport {logout, verifyUser} from \"../../actions/auth\";\nimport Loading from \"../loading/Loading\";\n\nconst PrivateRoute = ({component, role}) => {\n    const dispatch = useDispatch();\n    const navigate = useNavigate();\n    const [auth, setAuth] = useState(false);\n\n    useEffect(() => {\n\n        const onError = () => {\n            dispatch(logout);\n            navigate('/login');\n        }\n\n        const onSuccess = (user) => {\n            if (!role || role === user.role)\n                return setAuth(true);\n            navigate('/401');\n        }\n\n        dispatch(verifyUser(onSuccess, onError));\n    }, [dispatch, navigate, role])\n\n    if (auth)\n        return component;\n    return <Loading text={'Verifying'}/>\n}\n\nexport default PrivateRoute;"],"mappings":"0HAAA,OAAQA,WAAR,KAA0B,aAA1B,CACA,OAAQC,WAAR,KAA0B,kBAA1B,CACA,OAAQC,SAAR,CAAmBC,QAAnB,KAAkC,OAAlC,CACA,OAAQC,MAAR,CAAgBC,UAAhB,KAAiC,oBAAjC,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,C,2CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAuB,IAArBC,CAAAA,SAAqB,MAArBA,SAAqB,CAAVC,IAAU,MAAVA,IAAU,CACxC,GAAMC,CAAAA,QAAQ,CAAGV,WAAW,EAA5B,CACA,GAAMW,CAAAA,QAAQ,CAAGV,WAAW,EAA5B,CACA,cAAwBE,QAAQ,CAAC,KAAD,CAAhC,wCAAOS,IAAP,eAAaC,OAAb,eAEAX,SAAS,CAAC,UAAM,CAEZ,GAAMY,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CAClBJ,QAAQ,CAACN,MAAD,CAAR,CACAO,QAAQ,CAAC,QAAD,CAAR,CACH,CAHD,CAKA,GAAMI,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,IAAD,CAAU,CACxB,GAAI,CAACP,IAAD,EAASA,IAAI,GAAKO,IAAI,CAACP,IAA3B,CACI,MAAOI,CAAAA,OAAO,CAAC,IAAD,CAAd,CACJF,QAAQ,CAAC,MAAD,CAAR,CACH,CAJD,CAMAD,QAAQ,CAACL,UAAU,CAACU,SAAD,CAAYD,OAAZ,CAAX,CAAR,CACH,CAdQ,CAcN,CAACJ,QAAD,CAAWC,QAAX,CAAqBF,IAArB,CAdM,CAAT,CAgBA,GAAIG,IAAJ,CACI,MAAOJ,CAAAA,SAAP,CACJ,mBAAO,KAAC,OAAD,EAAS,IAAI,CAAE,WAAf,EAAP,CACH,CAxBD,CA0BA,cAAeD,CAAAA,YAAf"},"metadata":{},"sourceType":"module"}