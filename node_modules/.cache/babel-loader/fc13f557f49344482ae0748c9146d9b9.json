{"ast":null,"code":"import _slicedToArray from\"D:/ReactProjects/grocery-site/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from'./adminUpdateShipping.module.css';import{useState}from\"react\";import{useDispatch}from\"react-redux\";import Loading from\"../../../../components/loading/Loading\";import SuccessImage from'../../../../shared/assets/state/success.png';import WarningImage from'../../../../shared/assets/state/warning.png';import Error from\"../../../../components/feedback/error/Error\";import{useLocation}from\"react-router-dom\";import{useEffect}from\"react\";import{fetchShipment,updateShipment}from\"../../../../actions/shipping\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var INPUT=0;var SHIPPING_VIEW=1;var SUCCESS=2;var FAILURE=3;var AdminUpdateShipping=function AdminUpdateShipping(){var _useState=useState(INPUT),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),id=_useState4[0],setId=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),shipping=_useState6[0],setShipping=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),status=_useState10[0],setStatus=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),failureMessage=_useState12[0],setFailureMessage=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];var dispatch=useDispatch();var options=['CREATED','SHIPPED','DELIVERED','RETURNED'];var location=useLocation();useEffect(function(){var query=new URLSearchParams(location.search);var id=query.get('id');if(id){setId(id);}},[location.search]);var handleFind=function handleFind(){setLoading(true);var onSuccess=function onSuccess(shipping){setShipping(shipping);setState(SHIPPING_VIEW);setStatus(shipping.status);setLoading(false);};var onError=function onError(e){setLoading(false);setError(e.message);};dispatch(fetchShipment(id.toUpperCase(),onSuccess,onError));};var handleConfirm=function handleConfirm(){setLoading(true);var onSuccess=function onSuccess(){setState(SUCCESS);setLoading(false);};var onError=function onError(e){setState(FAILURE);setFailureMessage(e.message);setLoading(false);};dispatch(updateShipment(shipping.order_id,status,onSuccess,onError));};var handleReset=function handleReset(){setLoading(true);setId(\"\");setShipping({});setStatus(\"\");setFailureMessage(\"\");setError(\"\");setState(INPUT);setLoading(false);};useEffect(function(){window.scrollTo(0,0);},[state]);return/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper'],children:[error&&/*#__PURE__*/_jsx(Error,{error:error,setError:setError}),loading&&/*#__PURE__*/_jsx(Loading,{text:state===INPUT?'Fetching Database':state===SHIPPING_VIEW?'Updating Database':'Loading',overlay:true}),/*#__PURE__*/_jsx(\"div\",{className:'heading',children:/*#__PURE__*/_jsx(\"h1\",{children:\"Update Shipping Status\"})}),(state===INPUT||state===SHIPPING_VIEW)&&/*#__PURE__*/_jsxs(\"div\",{className:'warning-box',children:[/*#__PURE__*/_jsx(\"span\",{className:'warning',children:\"Warning:\"}),\" The shipping status cannot be rolled back to a previous state after it has been modified.\"]}),state===INPUT&&/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper2'],children:[/*#__PURE__*/_jsx(\"input\",{className:styles['input'],onChange:function onChange(e){return setId(e.target.value.toUpperCase());},value:id,maxLength:6,placeholder:'Order Id'}),/*#__PURE__*/_jsx(\"div\",{onClick:handleFind,className:'btn1',children:\"Find\"})]}),state===SHIPPING_VIEW&&/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper2'],children:[/*#__PURE__*/_jsxs(\"div\",{className:styles['options-wrapper'],children:[/*#__PURE__*/_jsx(\"div\",{className:styles['status'],children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{defaultValue:shipping.status,onChange:function onChange(e){return setStatus(e.target.value);},children:options.map(function(option,i){return/*#__PURE__*/_jsx(\"option\",{value:option,disabled:options.indexOf(option)<options.indexOf(shipping.status),children:option},i);})})]}),/*#__PURE__*/_jsx(\"div\",{onClick:handleConfirm,className:'btn1',children:\"Confirm Update\"})]}),state===SUCCESS&&/*#__PURE__*/_jsxs(\"div\",{className:styles['response-wrapper'],children:[/*#__PURE__*/_jsx(\"img\",{src:SuccessImage,alt:'Successfully Updated'}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Order #\",shipping.order_id,\" was successfully updated.\"]}),/*#__PURE__*/_jsx(\"div\",{className:'btn2',onClick:handleReset,children:\"Update More\"})]}),state===FAILURE&&/*#__PURE__*/_jsxs(\"div\",{className:styles['response-wrapper'],children:[/*#__PURE__*/_jsx(\"img\",{src:WarningImage,alt:'Successfully Updated'}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Failed to update order #\",id,\". \",failureMessage]}),/*#__PURE__*/_jsx(\"div\",{className:'btn2',onClick:handleReset,children:\"Retry\"})]})]});};export default AdminUpdateShipping;","map":{"version":3,"names":["styles","useState","useDispatch","Loading","SuccessImage","WarningImage","Error","useLocation","useEffect","fetchShipment","updateShipment","INPUT","SHIPPING_VIEW","SUCCESS","FAILURE","AdminUpdateShipping","state","setState","id","setId","shipping","setShipping","loading","setLoading","status","setStatus","failureMessage","setFailureMessage","error","setError","dispatch","options","location","query","URLSearchParams","search","get","handleFind","onSuccess","onError","e","message","toUpperCase","handleConfirm","order_id","handleReset","window","scrollTo","target","value","map","option","i","indexOf"],"sources":["D:/ReactProjects/grocery-site/client/src/pages/admin/shipment/update/AdminUpdateShipping.js"],"sourcesContent":["import styles from './adminUpdateShipping.module.css';\nimport {useState} from \"react\";\nimport {useDispatch} from \"react-redux\";\nimport Loading from \"../../../../components/loading/Loading\";\nimport SuccessImage from '../../../../shared/assets/state/success.png';\nimport WarningImage from '../../../../shared/assets/state/warning.png';\nimport Error from \"../../../../components/feedback/error/Error\";\nimport {useLocation} from \"react-router-dom\";\nimport {useEffect} from \"react\";\nimport {fetchShipment, updateShipment} from \"../../../../actions/shipping\";\n\nconst INPUT = 0;\nconst SHIPPING_VIEW = 1;\nconst SUCCESS = 2;\nconst FAILURE = 3;\n\nconst AdminUpdateShipping = () => {\n\n    const [state, setState] = useState(INPUT);\n    const [id, setId] = useState(\"\");\n    const [shipping, setShipping] = useState({});\n    const [loading, setLoading] = useState(false);\n    const [status, setStatus] = useState(\"\");\n    const [failureMessage, setFailureMessage] = useState(\"\");\n    const [error, setError] = useState(\"\");\n    const dispatch = useDispatch();\n    const options = ['CREATED', 'SHIPPED', 'DELIVERED', 'RETURNED'];\n    const location = useLocation();\n\n    useEffect(() => {\n        const query = new URLSearchParams(location.search);\n        const id = query.get('id');\n\n        if (id) {\n            setId(id);\n        }\n    }, [location.search])\n\n    const handleFind = () => {\n        setLoading(true);\n\n        const onSuccess = (shipping) => {\n            setShipping(shipping);\n            setState(SHIPPING_VIEW);\n            setStatus(shipping.status);\n            setLoading(false);\n        }\n\n        const onError = (e) => {\n            setLoading(false);\n            setError(e.message)\n        }\n\n        dispatch(fetchShipment(id.toUpperCase(), onSuccess, onError));\n    }\n\n    const handleConfirm = () => {\n        setLoading(true);\n\n        const onSuccess = () => {\n            setState(SUCCESS);\n            setLoading(false);\n        }\n\n        const onError = (e) => {\n            setState(FAILURE);\n            setFailureMessage(e.message);\n            setLoading(false)\n        }\n\n        dispatch(updateShipment(shipping.order_id, status, onSuccess, onError));\n    }\n\n    const handleReset = () => {\n        setLoading(true);\n        setId(\"\");\n        setShipping({});\n        setStatus(\"\");\n        setFailureMessage(\"\");\n        setError(\"\");\n        setState(INPUT);\n        setLoading(false);\n    }\n\n    useEffect(() => {\n        window.scrollTo(0, 0);\n    }, [state])\n\n    return (\n        <div className={styles['wrapper']}>\n            {error && <Error error={error} setError={setError}/>}\n            {loading && <Loading\n                text={state === INPUT ? 'Fetching Database' : (state === SHIPPING_VIEW ? 'Updating Database' : 'Loading')}\n                overlay={true}/>}\n            <div className={'heading'}>\n                <h1>Update Shipping Status</h1>\n            </div>\n            {(state === INPUT || state === SHIPPING_VIEW) &&\n                <div className={'warning-box'}><span className={'warning'}>Warning:</span> The shipping status cannot be\n                    rolled back to a previous\n                    state after it has been modified.</div>}\n            {state === INPUT &&\n                <div className={styles['wrapper2']}>\n                    <input className={styles['input']} onChange={(e) => setId(e.target.value.toUpperCase())} value={id}\n                           maxLength={6}\n                           placeholder={'Order Id'}/>\n                    <div onClick={handleFind} className={'btn1'}>Find</div>\n                </div>\n            }\n            {state === SHIPPING_VIEW &&\n                <div className={styles['wrapper2']}>\n                    <div className={styles['options-wrapper']}>\n                        <div className={styles['status']}>Status</div>\n                        <select defaultValue={shipping.status} onChange={(e) => setStatus(e.target.value)}>\n                            {options.map((option, i) =>\n                                <option\n                                    value={option}\n                                    key={i}\n                                    disabled={options.indexOf(option) < options.indexOf(shipping.status)}>{option}</option>)}\n                        </select>\n                    </div>\n                    <div onClick={handleConfirm} className={'btn1'}>Confirm Update</div>\n                </div>}\n            {state === SUCCESS &&\n                <div className={styles['response-wrapper']}>\n                    <img src={SuccessImage} alt={'Successfully Updated'}/>\n                    <p>Order #{shipping.order_id} was successfully updated.</p>\n                    <div className={'btn2'} onClick={handleReset}>Update More</div>\n                </div>}\n            {state === FAILURE &&\n                <div className={styles['response-wrapper']}>\n                    <img src={WarningImage} alt={'Successfully Updated'}/>\n                    <p>Failed to update order #{id}. {failureMessage}</p>\n                    <div className={'btn2'} onClick={handleReset}>Retry</div>\n                </div>}\n        </div>\n    );\n}\n\nexport default AdminUpdateShipping;"],"mappings":"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"},"metadata":{},"sourceType":"module"}