{"ast":null,"code":"import _slicedToArray from\"D:/ReactProjects/grocery-site/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from'./adminUpdateOrder.module.css';import{useState}from\"react\";import{useDispatch}from\"react-redux\";import{fetchOrder,updateOrder}from\"../../../../actions/orders\";import Loading from\"../../../../components/loading/Loading\";import OrderSummary from\"../../../../components/order-summary/OrderSummary\";import SuccessImage from'../../../../shared/assets/state/success.png';import WarningImage from'../../../../shared/assets/state/warning.png';import Error from\"../../../../components/feedback/error/Error\";import{useLocation}from\"react-router-dom\";import{useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var INPUT=0;var ORDER_VIEW=1;var SUCCESS=2;var FAILURE=3;var AdminUpdateOrder=function AdminUpdateOrder(){var _useState=useState(INPUT),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),id=_useState4[0],setId=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),order=_useState6[0],setOrder=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),status=_useState10[0],setStatus=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),failureMessage=_useState12[0],setFailureMessage=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];var dispatch=useDispatch();var options=['CREATED','PROCESSING','FULFILLED','CANCELLED'];var location=useLocation();useEffect(function(){var query=new URLSearchParams(location.search);var id=query.get('id');if(id){setId(id);}},[location.search]);var handleFind=function handleFind(){setLoading(true);var onSuccess=function onSuccess(order){setOrder(order);setState(ORDER_VIEW);setStatus(order.status);setLoading(false);};var onError=function onError(e){setLoading(false);setError(e.message);};dispatch(fetchOrder(id.toUpperCase(),onSuccess,onError));};var handleConfirm=function handleConfirm(){setLoading(true);var onSuccess=function onSuccess(){setState(SUCCESS);setLoading(false);};var onError=function onError(e){setState(FAILURE);setFailureMessage(e.message);setLoading(false);};dispatch(updateOrder(order.order_id,status,onSuccess,onError));};var handleReset=function handleReset(){setLoading(true);setId(\"\");setOrder({});setStatus(\"\");setFailureMessage(\"\");setError(\"\");setState(INPUT);setLoading(false);};useEffect(function(){window.scrollTo(0,0);},[state]);return/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper'],children:[error&&/*#__PURE__*/_jsx(Error,{error:error,setError:setError}),loading&&/*#__PURE__*/_jsx(Loading,{text:state===INPUT?'Fetching Database':state===ORDER_VIEW?'Updating Database':'Loading',overlay:true}),/*#__PURE__*/_jsx(\"div\",{className:'heading',children:/*#__PURE__*/_jsx(\"h1\",{children:\"Update Order Status\"})}),(state===INPUT||state===ORDER_VIEW)&&/*#__PURE__*/_jsxs(\"div\",{className:'warning-box',children:[/*#__PURE__*/_jsx(\"span\",{className:'warning',children:\"Warning:\"}),\" The order status cannot be rolled back to a previous state after it has been modified.\"]}),state===INPUT&&/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper2'],children:[/*#__PURE__*/_jsx(\"input\",{className:styles['input'],onChange:function onChange(e){return setId(e.target.value.toUpperCase());},value:id,maxLength:6,placeholder:'Order Id'}),/*#__PURE__*/_jsx(\"div\",{onClick:handleFind,className:'btn1',children:\"Find\"})]}),state===ORDER_VIEW&&/*#__PURE__*/_jsxs(\"div\",{className:styles['wrapper2'],children:[/*#__PURE__*/_jsx(OrderSummary,{order:order}),/*#__PURE__*/_jsxs(\"div\",{className:styles['options-wrapper'],children:[/*#__PURE__*/_jsx(\"div\",{className:styles['status'],children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{defaultValue:order.status,onChange:function onChange(e){return setStatus(e.target.value);},children:options.map(function(option,i){return/*#__PURE__*/_jsx(\"option\",{value:option,disabled:options.indexOf(option)<options.indexOf(order.status),children:option},i);})})]}),/*#__PURE__*/_jsx(\"div\",{onClick:handleConfirm,className:'btn1',children:\"Confirm Update\"})]}),state===SUCCESS&&/*#__PURE__*/_jsxs(\"div\",{className:styles['response-wrapper'],children:[/*#__PURE__*/_jsx(\"img\",{src:SuccessImage,alt:'Successfully Updated'}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Order #\",order.order_id,\" was successfully updated.\"]}),/*#__PURE__*/_jsx(\"div\",{className:'btn2',onClick:handleReset,children:\"Update More\"})]}),state===FAILURE&&/*#__PURE__*/_jsxs(\"div\",{className:styles['response-wrapper'],children:[/*#__PURE__*/_jsx(\"img\",{src:WarningImage,alt:'Successfully Updated'}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Failed to update order #\",id,\". \",failureMessage]}),/*#__PURE__*/_jsx(\"div\",{className:'btn2',onClick:handleReset,children:\"Retry\"})]})]});};export default AdminUpdateOrder;","map":{"version":3,"names":["styles","useState","useDispatch","fetchOrder","updateOrder","Loading","OrderSummary","SuccessImage","WarningImage","Error","useLocation","useEffect","INPUT","ORDER_VIEW","SUCCESS","FAILURE","AdminUpdateOrder","state","setState","id","setId","order","setOrder","loading","setLoading","status","setStatus","failureMessage","setFailureMessage","error","setError","dispatch","options","location","query","URLSearchParams","search","get","handleFind","onSuccess","onError","e","message","toUpperCase","handleConfirm","order_id","handleReset","window","scrollTo","target","value","map","option","i","indexOf"],"sources":["D:/ReactProjects/grocery-site/client/src/pages/admin/orders/update/AdminUpdateOrder.js"],"sourcesContent":["import styles from './adminUpdateOrder.module.css';\nimport {useState} from \"react\";\nimport {useDispatch} from \"react-redux\";\nimport {fetchOrder, updateOrder} from \"../../../../actions/orders\";\nimport Loading from \"../../../../components/loading/Loading\";\nimport OrderSummary from \"../../../../components/order-summary/OrderSummary\";\n\nimport SuccessImage from '../../../../shared/assets/state/success.png';\nimport WarningImage from '../../../../shared/assets/state/warning.png';\nimport Error from \"../../../../components/feedback/error/Error\";\nimport {useLocation} from \"react-router-dom\";\nimport {useEffect} from \"react\";\n\nconst INPUT = 0;\nconst ORDER_VIEW = 1;\nconst SUCCESS = 2;\nconst FAILURE = 3;\n\nconst AdminUpdateOrder = () => {\n\n    const [state, setState] = useState(INPUT);\n    const [id, setId] = useState(\"\");\n    const [order, setOrder] = useState({});\n    const [loading, setLoading] = useState(false);\n    const [status, setStatus] = useState(\"\");\n    const [failureMessage, setFailureMessage] = useState(\"\");\n    const [error, setError] = useState(\"\");\n    const dispatch = useDispatch();\n    const options = ['CREATED', 'PROCESSING', 'FULFILLED', 'CANCELLED'];\n    const location = useLocation();\n\n    useEffect(() => {\n        const query = new URLSearchParams(location.search);\n        const id = query.get('id');\n\n        if (id) {\n            setId(id);\n        }\n    }, [location.search])\n\n    const handleFind = () => {\n        setLoading(true);\n\n        const onSuccess = (order) => {\n            setOrder(order);\n            setState(ORDER_VIEW);\n            setStatus(order.status);\n            setLoading(false);\n        }\n\n        const onError = (e) => {\n            setLoading(false);\n            setError(e.message)\n        }\n\n        dispatch(fetchOrder(id.toUpperCase(), onSuccess, onError));\n    }\n\n    const handleConfirm = () => {\n        setLoading(true);\n\n        const onSuccess = () => {\n            setState(SUCCESS);\n            setLoading(false);\n        }\n\n        const onError = (e) => {\n            setState(FAILURE);\n            setFailureMessage(e.message);\n            setLoading(false)\n        }\n\n        dispatch(updateOrder(order.order_id, status, onSuccess, onError));\n    }\n\n    const handleReset = () => {\n        setLoading(true);\n        setId(\"\");\n        setOrder({});\n        setStatus(\"\");\n        setFailureMessage(\"\");\n        setError(\"\");\n        setState(INPUT);\n        setLoading(false);\n    }\n\n    useEffect(() => {\n        window.scrollTo(0, 0);\n    }, [state])\n\n    return (\n        <div className={styles['wrapper']}>\n            {error && <Error error={error} setError={setError}/>}\n            {loading && <Loading\n                text={state === INPUT ? 'Fetching Database' : (state === ORDER_VIEW ? 'Updating Database' : 'Loading')}\n                overlay={true}/>}\n            <div className={'heading'}>\n                <h1>Update Order Status</h1>\n            </div>\n            {(state === INPUT || state === ORDER_VIEW) &&\n                <div className={'warning-box'}><span className={'warning'}>Warning:</span> The order status cannot be\n                    rolled back to a previous\n                    state after it has been modified.</div>}\n            {state === INPUT &&\n                <div className={styles['wrapper2']}>\n                    <input className={styles['input']} onChange={(e) => setId(e.target.value.toUpperCase())} value={id}\n                           maxLength={6}\n                           placeholder={'Order Id'}/>\n                    <div onClick={handleFind} className={'btn1'}>Find</div>\n                </div>\n            }\n            {state === ORDER_VIEW &&\n                <div className={styles['wrapper2']}>\n                    <OrderSummary order={order}/>\n                    <div className={styles['options-wrapper']}>\n                        <div className={styles['status']}>Status</div>\n                        <select defaultValue={order.status} onChange={(e) => setStatus(e.target.value)}>\n                            {options.map((option, i) =>\n                                <option\n                                    value={option}\n                                    key={i}\n                                    disabled={options.indexOf(option) < options.indexOf(order.status)}>{option}</option>)}\n                        </select>\n                    </div>\n                    <div onClick={handleConfirm} className={'btn1'}>Confirm Update</div>\n                </div>}\n            {state === SUCCESS &&\n                <div className={styles['response-wrapper']}>\n                    <img src={SuccessImage} alt={'Successfully Updated'}/>\n                    <p>Order #{order.order_id} was successfully updated.</p>\n                    <div className={'btn2'} onClick={handleReset}>Update More</div>\n                </div>}\n            {state === FAILURE &&\n                <div className={styles['response-wrapper']}>\n                    <img src={WarningImage} alt={'Successfully Updated'}/>\n                    <p>Failed to update order #{id}. {failureMessage}</p>\n                    <div className={'btn2'} onClick={handleReset}>Retry</div>\n                </div>}\n        </div>\n    );\n}\n\nexport default AdminUpdateOrder;"],"mappings":"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"},"metadata":{},"sourceType":"module"}